<div class="mb-4 flex justify-between">
    <div class="flex w-[120px]">
        <button
            class="text-sm p-1 px-3 rounded-md"
            :class="[selectedContract.options?.moduleContract ? 'bg-neutral-800 text-neutral-400 cursor-not-allowed' : 'bg-green-800 hover:bg-green-700 cursor-pointer']"
            @click="addService()"
        >
            New Method
        </button>
    </div>
    <div v-if="hasController()" class="flex items-center">
        <span class="text-xs text-neutral-400 mr-2">Controller enabled:</span>
        <span class="text-xs px-2 py-1 bg-green-800 rounded-md"
            >CRUD methods generated</span
        >
    </div>
</div>

<div v-if="hasController()" class="mb-6">
    <div
        class="px-3 py-2 text-xs font-semibold text-neutral-400 uppercase bg-neutral-850 mb-2"
    >
        Standard CRUD Methods
    </div>

    <div
        class="mb-4 border w-full border-neutral-800 p-1 rounded-md flex-colum gap-x-4 bg-opacity-50 bg-neutral-900"
    >
        <div class="flex">
            <div
                class="flex items-center justify-center w-[80px] min-w-[80px] h-[42px] border-r border-neutral-800 bg-blue-900"
            >
                <span class="font-mono text-sm font-bold">GET</span>
            </div>

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value="GetAll"
                title="Method Name"
                disabled
            />

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value=""
                title="Path (base path)"
                disabled
            />

            <div
                class="flex p-2 border-l border-neutral-800 ml-auto"
                title="System Generated"
            >
                <span class="text-xs text-neutral-500 italic"
                    >Auto-generated</span
                >
            </div>
        </div>
    </div>

    <div
        class="mb-4 border w-full border-neutral-800 p-1 rounded-md flex-colum gap-x-4 bg-opacity-50 bg-neutral-900"
    >
        <div class="flex">
            <div
                class="flex items-center justify-center w-[80px] min-w-[80px] h-[42px] border-r border-neutral-800 bg-blue-900"
            >
                <span class="font-mono text-sm font-bold">GET</span>
            </div>

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value="GetById"
                title="Method Name"
                disabled
            />

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value=":id"
                title="Path"
                disabled
            />

            <div
                class="flex p-2 border-l border-neutral-800 ml-auto"
                title="System Generated"
            >
                <span class="text-xs text-neutral-500 italic"
                    >Auto-generated</span
                >
            </div>
        </div>
    </div>

    <div
        class="mb-4 border w-full border-neutral-800 p-1 rounded-md flex-colum gap-x-4 bg-opacity-50 bg-neutral-900"
    >
        <div class="flex">
            <div
                class="flex items-center justify-center w-[80px] min-w-[80px] h-[42px] border-r border-neutral-800 bg-blue-900"
            >
                <span class="font-mono text-sm font-bold">GET</span>
            </div>

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value="GetIn"
                title="Method Name"
                disabled
            />

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value="in"
                title="Path"
                disabled
            />

            <div
                class="flex p-2 border-l border-neutral-800 ml-auto"
                title="System Generated"
            >
                <span class="text-xs text-neutral-500 italic"
                    >Auto-generated</span
                >
            </div>
        </div>
    </div>

    <div
        class="mb-4 border w-full border-neutral-800 p-1 rounded-md flex-colum gap-x-4 bg-opacity-50 bg-neutral-900"
    >
        <div class="flex">
            <div
                class="flex items-center justify-center w-[80px] min-w-[80px] h-[42px] border-r border-neutral-800 bg-green-900"
            >
                <span class="font-mono text-sm font-bold">POST</span>
            </div>

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value="Create"
                title="Method Name"
                disabled
            />

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value=""
                title="Path (base path)"
                disabled
            />

            <div
                class="flex p-2 border-l border-neutral-800 ml-auto"
                title="System Generated"
            >
                <span class="text-xs text-neutral-500 italic"
                    >Auto-generated</span
                >
            </div>
        </div>
    </div>

    <div
        class="mb-4 border w-full border-neutral-800 p-1 rounded-md flex-colum gap-x-4 bg-opacity-50 bg-neutral-900"
    >
        <div class="flex">
            <div
                class="flex items-center justify-center w-[80px] min-w-[80px] h-[42px] border-r border-neutral-800 bg-yellow-900"
            >
                <span class="font-mono text-sm font-bold">PUT</span>
            </div>

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value="Update"
                title="Method Name"
                disabled
            />

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value=":id"
                title="Path"
                disabled
            />

            <div
                class="flex p-2 border-l border-neutral-800 ml-auto"
                title="System Generated"
            >
                <span class="text-xs text-neutral-500 italic"
                    >Auto-generated</span
                >
            </div>
        </div>
    </div>

    <div
        class="mb-4 border w-full border-neutral-800 p-1 rounded-md flex-colum gap-x-4 bg-opacity-50 bg-neutral-900"
    >
        <div class="flex">
            <div
                class="flex items-center justify-center w-[80px] min-w-[80px] h-[42px] border-r border-neutral-800 bg-red-900"
            >
                <span class="font-mono text-sm font-bold">DELETE</span>
            </div>

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value="Delete"
                title="Method Name"
                disabled
            />

            <input
                class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none bg-neutral-900"
                type="text"
                value=":id"
                title="Path"
                disabled
            />

            <div
                class="flex p-2 border-l border-neutral-800 ml-auto"
                title="System Generated"
            >
                <span class="text-xs text-neutral-500 italic"
                    >Auto-generated</span
                >
            </div>
        </div>
    </div>
</div>

<div
    v-if="selectedContract.services && selectedContract.services.length > 0"
    class="px-3 py-2 text-xs font-semibold text-neutral-400 uppercase bg-neutral-850 mb-2"
>
    Custom Methods
</div>

<div
    v-if="!selectedContract.services || selectedContract.services.length === 0"
    class="border border-dashed border-neutral-700 rounded-md p-6 mb-4 text-center"
>
    <svg
        class="h-12 w-12 mx-auto mb-3 text-neutral-500"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="currentColor"
        color="text-neutral-600 dark:text-white"
        aria-hidden="true"
    >
        <path d="M2.01 21L23 12L2.01 3L2 10L17 12L2 14L2.01 21Z"></path>
    </svg>

    <h3 class="text-lg font-medium text-neutral-400 mb-1">No Custom Methods</h3>
    <p class="text-sm text-neutral-500 mb-4">
        You haven't defined any custom methods for this contract yet.
    </p>
    <button
        class="text-sm p-2 px-4 rounded-md bg-green-800 hover:bg-green-700 cursor-pointer transition-colors"
        @click="addService()"
        :disabled="selectedContract.options?.moduleContract"
        :class="{'opacity-50 cursor-not-allowed': selectedContract.options?.moduleContract}"
    >
        Create Your First Method
    </button>
</div>

<div
    v-for="(service, serviceKey) in selectedContract.services"
    class="mb-4 border w-full border-neutral-800 p-1 rounded-md flex-colum gap-x-4"
>
    <div class="flex">
        <div
            class="flex items-center justify-center w-[80px] min-w-[80px] h-[42px] border-r border-neutral-800"
            :class="{
                'bg-blue-900': service.method === 'GET',
                'bg-green-900': service.method === 'POST',
                'bg-yellow-900': service.method === 'PUT',
                'bg-red-900': service.method === 'DELETE'
            }"
        >
            <span class="font-mono text-sm font-bold"
                >{{ service.method }}</span
            >
        </div>

        <input
            class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none"
            type="text"
            placeholder="Method Name"
            title="Method Name"
            v-model="service.name"
            :disabled="selectedContract.options?.moduleContract"
        />

        <input
            class="border-l pl-4 h-[42px] w-[250px] min-w-[250px] border-neutral-800 focus-none outline-none"
            type="text"
            placeholder="Path"
            title="Path"
            v-model="service.path"
            :disabled="selectedContract.options?.moduleContract"
        />

        <div class="flex p-1 border-l border-neutral-800 ml-auto" title="More">
            <button
                class="items-center justify-center flex select-none cursor-pointer mr-2 ml-2"
                @click="toggleServiceOpened(service.name)"
            >
                <svg
                    width="18"
                    height="18"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                >
                    <path
                        fill-rule="evenodd"
                        d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"
                        clip-rule="evenodd"
                    ></path>
                </svg>
            </button>
        </div>

        <div class="flex p-2 border-l border-neutral-800" title="More">
            <button
                class="items-center justify-center flex select-none mt-1 ml-1"
                :class="[selectedContract.options?.moduleContract ? 'text-neutral-600 cursor-not-allowed' : 'text-red-500 cursor-pointer']"
                @click="removeService(service.name, serviceKey)"
                title="Remove Method"
            >
                <svg
                    width="18"
                    height="18"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                >
                    <path
                        fill-rule="evenodd"
                        d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z"
                        clip-rule="evenodd"
                    ></path>
                </svg>
            </button>
        </div>
    </div>

    <div
        class="flex-colums border-t min-h-[200px] flex-1 border-neutral-800 p-4"
        v-show="isServiceOpened(service.name) ?? false"
    >
        <div
            class="flex border-b border-neutral-800 mb-4 pb-1 text-neutral-500"
        >
            Method Configuration
        </div>

        <div class="flex text-xs justify-center mt-2">
            <div class="w-[200px] flex items-center">HTTP Method:</div>
            <div class="w-[calc(100%-200px)] justify-end">
                <select
                    class="border pl-4 h-[42px] w-full outline-none bg-neutral-900 border-neutral-800"
                    v-model="service.method"
                    :disabled="selectedContract.options?.moduleContract"
                >
                    <option value="GET">GET</option>
                    <option value="POST">POST</option>
                    <option value="PUT">PUT</option>
                    <option value="DELETE">DELETE</option>
                </select>
            </div>
        </div>

        <div class="flex text-xs justify-center mt-2">
            <div class="w-[200px] flex items-center">Function Name:</div>
            <div class="w-[calc(100%-200px)] justify-end">
                <input
                    class="border pl-4 h-[42px] w-full border-neutral-800 focus-none outline-none"
                    type="text"
                    placeholder="Function name for the method implementation"
                    v-model="service.functionName"
                    :disabled="selectedContract.options?.moduleContract"
                />
            </div>
        </div>

        <div class="flex text-xs justify-center mt-2">
            <div class="w-[200px] flex items-center">Request DTO:</div>
            <div class="w-[calc(100%-200px)] justify-end">
                <select
                    class="border pl-4 h-[42px] w-full outline-none bg-neutral-900 border-neutral-800"
                    v-model="service.request"
                    :disabled="selectedContract.options?.moduleContract"
                >
                    <option value="">None</option>
                    <option
                        v-for="message in selectedContract.messages"
                        :value="message.name"
                    >
                        {{ message.name }}
                    </option>
                </select>
            </div>
        </div>

        <div class="flex text-xs justify-center mt-2">
            <div class="w-[200px] flex items-center">Response DTO:</div>
            <div class="w-[calc(100%-200px)] justify-end">
                <select
                    class="border pl-4 h-[42px] w-full outline-none bg-neutral-900 border-neutral-800"
                    v-model="service.response"
                    :disabled="selectedContract.options?.moduleContract"
                >
                    <option value="">None</option>
                    <option
                        v-for="message in selectedContract.messages"
                        :value="message.name"
                    >
                        {{ message.name }}
                    </option>
                </select>
            </div>
        </div>

        <div class="flex text-xs justify-center mt-4">
            <div class="w-[200px] flex items-center">
                Requires Authentication:
            </div>
            <div class="w-[calc(100%-200px)] justify-start">
                <input
                    type="checkbox"
                    class="w-3 h-3 mr-2 text-blue-600 bg-neutral-800 dark:bg-gray-700 rounded-sm focus:ring-blue-800 focus:ring-2 rounded-md"
                    v-model="service.auth"
                    title="Requires Authentication"
                    :disabled="selectedContract.options?.moduleContract"
                />
            </div>
        </div>

        <div class="flex text-xs justify-center mt-2">
            <div class="w-[200px] flex items-center">Create Boilerplate:</div>
            <div class="w-[calc(100%-200px)] justify-start">
                <input
                    type="checkbox"
                    class="w-3 h-3 mr-2 text-blue-600 bg-neutral-800 dark:bg-gray-700 rounded-sm focus:ring-blue-800 focus:ring-2 rounded-md"
                    v-model="service.createBoilerplate"
                    title="Create Boilerplate Code"
                    :disabled="selectedContract.options?.moduleContract"
                />
                <span class="text-neutral-500 ml-2"
                    >Generate implementation template for this method</span
                >
            </div>
        </div>

        <div class="p-2 bg-neutral-800 rounded-md mt-6">
            <pre>{{ JSON.stringify(service, null, 4) }}</pre>
        </div>
    </div>
</div>
